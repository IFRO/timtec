{% extends 'base.html' %}

{% load compress %}
{% load static %}
{% load i18n %}

{% block js %}
    {{ block.super }}
    {% compress js %}
        <script type="text/javascript" src="{% static 'js/messages/app.js' %}"></script>
        <script type="text/javascript" src="{% static 'js/messages/controllers.js' %}"></script>
        <script type="text/javascript" src="{% static 'js/messages/services.js' %}"></script>
        <script type="text/javascript" src="{% static 'angular-ui-tinymce/src/tinymce.js' %}"></script>
        <script type="text/javascript" src="{% static 'js/factories/timtec-models.js' %}"></script>
        <script type="text/javascript" src="{% static 'checklist-model/checklist-model.js' %}"></script>
        <script type="text/javascript" src="{% static 'js/markdown/app.js' %}"></script>
        <script type="text/javascript" src="{% static 'js/markdown/filters.js' %}"></script>
    {% endcompress %}
{% endblock %}

{% block css %}
    {% compress css %}
        <link rel="stylesheet" href="{% static 'tinymce-dist/skins/lightgray/skin.min.css' %}" type="text/css" />
        <link rel="stylesheet" href="{% static 'tinymce-dist/skins/lightgray/skin.ie7.min.css' %}" type="text/css" />
        <link rel="stylesheet" href="{% static 'tinymce-dist/skins/lightgray/content.min.css' %}" type="text/css" />
    {% endcompress %}
{% endblock %}

{% block body_attrs %}ng-app='messages'{% endblock %}

{% block content %}
    <section id="user-messages" class="container" ng-controller="AllMessagesController">
        <header class="secondary-header">
            <div class="row">
                <div class="col-xs-12">
                    <h1>{% trans "Messages" %}</h1>
                </div>
            </div>
        </header>
        <div class="row" ng-show="!showing_message">
            <div class="col-sm-12 col-md-6" >
                <div class="input-group" id="adv-search">
                    <input type="text" class="form-control" placeholder="Search for snippets" />
                    <div class="input-group-btn search-box">
                        <div class="btn-group" role="group">
                            <div class="dropdown dropdown-lg">
                                <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-expanded="false"><span class="caret"></span></button>
                                <div class="dropdown-menu dropdown-menu-right" role="menu">
                                    <form class="form-horizontal" role="form">
                                      <div class="form-group">
                                        <label for="filter">Filter by</label>
                                        <select class="form-control">
                                            <option value="0" selected>All Snippets</option>
                                            <option value="1">Featured</option>
                                            <option value="2">Most popular</option>
                                            <option value="3">Top rated</option>
                                            <option value="4">Most commented</option>
                                        </select>
                                      </div>
                                      <div class="form-group">
                                        <label for="contain">Author</label>
                                        <input class="form-control" type="text" />
                                      </div>
                                      <div class="form-group">
                                        <label for="contain">Contains the words</label>
                                        <input class="form-control" type="text" />
                                      </div>
                                      <button type="submit" class="btn btn-primary"><span class="glyphicon glyphicon-search" aria-hidden="true"></span></button>
                                    </form>
                                </div>
                            </div>
                            <button type="button" class="btn btn-primary"><span class="glyphicon glyphicon-search" aria-hidden="true"></span></button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-sm-12 col-md-6">
                <div class="btn-group">
                    <button type="button" class="btn btn-default message-actions">
                        <label>
                            <input type="checkbox">
                        </label>
                    </button>
                    <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
                        <span class="caret"></span><span class="sr-only">Toggle Dropdown</span>
                    </button>
                    <ul class="dropdown-menu" role="menu">
                        <li><a href="#">All</a></li>
                        <li><a href="#">None</a></li>
                        <li><a href="#">Read</a></li>
                        <li><a href="#">Unread</a></li>
                        <li><a href="#">Starred</a></li>
                        <li><a href="#">Unstarred</a></li>
                    </ul>
                </div>
                <button type="button" class="btn btn-default" data-toggle="tooltip" title="Atualizar" ng-click="load_messages()">
                    &nbsp;&nbsp;&nbsp;<span class="glyphicon glyphicon-refresh"></span>&nbsp;&nbsp;&nbsp;</button>
                <div class="pull-right">
                    <span class="text-muted"><b>1</b>â€“<b>50</b> of <b>160</b></span>
                    <div class="btn-group btn-group-sm">
                        <button type="button" class="btn btn-default">
                            <span class="glyphicon glyphicon-chevron-left"></span>
                        </button>
                        <button type="button" class="btn btn-default">
                            <span class="glyphicon glyphicon-chevron-right"></span>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <div class="row" ng-show="showing_message">
            <button type="button" class="btn btn-default" data-toggle="tooltip" title="Voltar" ng-click="hide_message()">
                    &nbsp;&nbsp;&nbsp;<span class="glyphicon glyphicon-undo"></span>&nbsp;&nbsp;&nbsp;</button>
        </div>
        <hr>

        <div class="row">
            <div class="col-xs-12" ng-show="loading_messages">
                <p>{% trans 'Loading messages' %}...   <i class="loading fa fa-refresh fa-spin"></i></p>
            </div>

        </div>

        <div class="row">
            <div class="col-xs-12">
                <div class="tab-content">
                    <!-- list messages -->
                    <div class="tab-pane" ng-class="{'active': !showing_message}">
                        <div class="list-group">
                            {% verbatim %}
                                <a href="#" ng-click="show_message(message)" class="list-group-item" ng-repeat="message in messages">
                                    <label>
                                        <input type="checkbox">
                                    </label>
                                    <span class="name" style="min-width: 120px; display: inline-block;">{{ message.professor }}</span>
                                    <span class="subject" ng-bind-html="message.subject"></span> -
                                    <span class="text-muted" style="font-size: 11px;" ng-bind-html="message.message_clean"></span>
                                    <span class="badge">{{ message.date|date:'dd/MM/yy HH:mm' }}</span>
                                </a>
                            {% endverbatim %}
                        </div>
                    </div>

                    <!-- single message -->
                    <div class="tab-pane message" ng-class="{'active': showing_message}">
                        <h2 ng-bind-html="showing_message.subject"></h2>
                        <span ng-bind-html="showing_message.professor"></span>
                        <span class="message-timestamp pull-right" ng-bind-html="showing_message.date|date:'dd/MM/yy HH:mm'"></span>
                        <span ng-bind-html="showing_message.message"></span>
                    </div>
                </div>
            </div>
        </div>

    </section>
{% endblock %}
